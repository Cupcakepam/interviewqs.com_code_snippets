<div class="container" id="notebook-container">
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">

<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Create-a-dataframe">Create a dataframe</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#create a dataframe</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Willard Morris'</span><span class="p">,</span> <span class="s1">'Al Jennings'</span><span class="p">],</span>
        <span class="s1">'age'</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
        <span class="s1">'favorite_color'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'blue'</span><span class="p">,</span> <span class="s1">'red'</span><span class="p">],</span>
        <span class="s1">'grade'</span><span class="p">:</span> <span class="p">[</span><span class="mi">88</span><span class="p">,</span> <span class="mi">92</span><span class="p">],</span>
        <span class="s1">'grade'</span><span class="p">:</span> <span class="p">[</span><span class="mi">88</span><span class="p">,</span> <span class="mi">92</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Willard Morris'</span><span class="p">,</span> <span class="s1">'Al Jennings'</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>age</th>
<th>favorite_color</th>
<th>grade</th>
<th>grade</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<th>Willard Morris</th>
<td>20</td>
<td>blue</td>
<td>88</td>
<td>88</td>
<td>Willard Morris</td>
</tr>
<tr>
<th>Al Jennings</th>
<td>19</td>
<td>red</td>
<td>92</td>
<td>92</td>
<td>Al Jennings</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">

<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Remove-duplicate-columns-(based-on-column-name)"><br/>Remove duplicate columns (based on column name)</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#preview the df</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>age</th>
<th>favorite_color</th>
<th>grade</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<th>Willard Morris</th>
<td>20</td>
<td>blue</td>
<td>88</td>
<td>Willard Morris</td>
</tr>
<tr>
<th>Al Jennings</th>
<td>19</td>
<td>red</td>
<td>92</td>
<td>Al Jennings</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">

<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>df.columns.duplicated() returns a boolean array: a True or False for each column.<br>
--False means the column name is unique up to that point, True means it's a duplicate</br></p>
<p>Pandas allows one to index using boolean values whereby it selects only the True values.</p>
<p>Since we want to keep the unduplicated columns, we need the above boolean array to be<br>
flipped (ie [True, False, True] -&gt; ~[False,True,False])</br></p>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
